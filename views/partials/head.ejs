<!DOCTYPE html>
<html lang="<%= lang || 'ko' %>">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= title || (t.meta && t.meta.defaultTitle) || 'Gangnam King' %></title>
    <meta
      name="description"
      content="<%= (typeof description === 'string' && description.length) ? description : ((t.meta && t.meta.description) || '') %>"
    />
    <meta name="robots" content="index, follow" />
    <meta name="googlebot" content="index, follow" />
    <% const viewLocals = (typeof locals === 'object' && locals !== null) ? locals : {}; %>
    <% const rawSeoKeywords =
      Object.prototype.hasOwnProperty.call(viewLocals, 'seoKeywords')
        ? viewLocals.seoKeywords
        : [];
    %>
    <% const resolvedSeoKeywords =
      typeof rawSeoKeywords === 'string'
        ? [rawSeoKeywords]
        : (Array.isArray(rawSeoKeywords) ? rawSeoKeywords.filter(function (keyword) {
            return typeof keyword === 'string' && keyword.trim();
          }) : []);
    %>
    <% if (resolvedSeoKeywords.length) { %>
      <meta name="keywords" content="<%= resolvedSeoKeywords.join(', ') %>" />
    <% } %>
    <meta property="og:type" content="website" />
    <meta property="og:title" content="<%= title || (t.meta && t.meta.defaultTitle) || 'Gangnam King' %>" />
    <meta
      property="og:description"
      content="<%= (typeof description === 'string' && description.length) ? description : ((t.meta && t.meta.description) || '') %>"
    />
    <meta property="og:site_name" content="<%= (t.meta && t.meta.siteName) || 'Gangnam King' %>" />
    <% const resolvedCanonicalUrl =
      typeof viewLocals.canonicalUrl === 'string' && viewLocals.canonicalUrl.trim()
        ? viewLocals.canonicalUrl
        : '/';
    %>
    <meta property="og:url" content="<%= resolvedCanonicalUrl %>" />
    <link rel="canonical" href="<%= resolvedCanonicalUrl %>" />
    <% const resolvedLanguageOptions = Array.isArray(viewLocals.languageOptions) ? viewLocals.languageOptions : []; %>
    <% const resolvedDefaultLanguage =
      typeof viewLocals.defaultLanguage === 'string' && viewLocals.defaultLanguage.trim()
        ? viewLocals.defaultLanguage
        : '';
    %>
    <% if (resolvedLanguageOptions.length) { %>
      <% resolvedLanguageOptions.forEach(function(option) { %>
        <link rel="alternate" hreflang="<%= option.code %>" href="<%= option.absoluteUrl %>" />
      <% }) %>
      <% const defaultOption = resolvedLanguageOptions.find(function(option) { return option.code === resolvedDefaultLanguage; }) || resolvedLanguageOptions[0]; %>
      <% if (defaultOption) { %>
        <link rel="alternate" hreflang="x-default" href="<%= defaultOption.absoluteUrl %>" />
      <% } %>
    <% } %>
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-roompang.png" />
    <link rel="apple-touch-icon" href="/images/favicon-roompang.png" />
    <link rel="stylesheet" href="/styles/main.css" />
    <% const rawExtraStyles =
      Object.prototype.hasOwnProperty.call(viewLocals, 'extraStyles')
        ? viewLocals.extraStyles
        : [];
    %>
    <% const resolvedExtraStyles =
      typeof rawExtraStyles === 'string'
        ? [rawExtraStyles]
        : (Array.isArray(rawExtraStyles) ? rawExtraStyles.filter(function (href) {
            return typeof href === 'string' && href.trim();
          }) : []);
    %>
    <% if (resolvedExtraStyles.length) { %>
      <% resolvedExtraStyles.forEach(function (href) { %>
        <link rel="stylesheet" href="<%= href %>" />
      <% }) %>
    <% } %>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <% const currentLanguageOption = resolvedLanguageOptions.find(function(option) { return option.isCurrent; }) || resolvedLanguageOptions[0]; %>
    <% const languageSelectId = 'language-select'; %>
    <% const resolvedAreaFilterConfig = (typeof viewLocals.areaFilterConfig === 'object' && viewLocals.areaFilterConfig !== null)
      ? viewLocals.areaFilterConfig
      : {};
    %>
    <% const cityFilterOptions = Array.isArray(resolvedAreaFilterConfig.cities) ? resolvedAreaFilterConfig.cities : []; %>
    <header class="site-header">
      <div class="container site-header__main">
        <a class="branding" href="/">
          <img
            class="branding__logo"
            src="/images/logo-roompang.png"
            alt="<%= (t.meta && t.meta.siteName) || '룸빵1번지' %>"
          />
          <span class="branding__text">룸빵1번지</span>
        </a>
      </div>
      <% if (cityFilterOptions.length || currentLanguageOption) { %>
        <div class="site-subheader">
          <div class="container site-subheader__container">
            <div class="site-subheader__top-row">
              <% if (cityFilterOptions.length) { %>
                <div class="site-subheader__filters">
                  <nav
                    class="area-filter area-filter--cities"
                    data-area-filter
                    data-all-label="<%= resolvedAreaFilterConfig.allLabel || '전체' %>"
                  >
                    <% cityFilterOptions.forEach(function(option) { %>
                      <button
                        type="button"
                        class="area-filter__button"
                        data-city-option="<%= option.value %>"
                      >
                        <%= option.label %>
                      </button>
                    <% }) %>
                  </nav>
                </div>
              <% } %>
            </div>
            <% if (cityFilterOptions.length) { %>
              <div class="area-filter area-filter--districts" data-city-district-bar hidden></div>
            <% } %>
          </div>
        </div>
      <% } %>
      <% if (cityFilterOptions.length) { %>
        <div class="area-menu" id="area-menu" data-area-menu hidden>
          <div class="area-menu__overlay" data-area-menu-close></div>
          <div class="area-menu__panel" role="dialog" aria-modal="true" aria-labelledby="area-menu-title">
            <header class="area-menu__header">
              <h2 class="area-menu__title" id="area-menu-title"><%= resolvedAreaFilterConfig.label || '지역 선택' %></h2>
              <button type="button" class="area-menu__close" data-area-menu-close aria-label="닫기">×</button>
            </header>
            <div class="area-menu__body">
              <div class="area-menu__groups" role="tablist">
                <button
                  type="button"
                  class="area-menu__group-button is-active"
                  data-area-group="all"
                  data-area-group-label="<%= resolvedAreaFilterConfig.allLabel || '전체' %>"
                >
                  <%= resolvedAreaFilterConfig.allLabel || '전체' %>
                </button>
                <% cityFilterOptions.forEach(function(option) { %>
                  <button
                    type="button"
                    class="area-menu__group-button"
                    data-area-group="<%= option.value %>"
                    data-area-group-label="<%= option.label %>"
                  >
                    <%= option.label %>
                  </button>
                <% }) %>
              </div>
              <div class="area-menu__lists">
                <div
                  class="area-menu__list is-active"
                  data-area-group-panel="all"
                  data-area-group-label="<%= resolvedAreaFilterConfig.allLabel || '전체' %>"
                >
                  <button
                    type="button"
                    class="area-menu__action"
                    data-area-menu-action
                    data-region="all"
                    data-district="all"
                  >
                    <%= resolvedAreaFilterConfig.allLabel || '전체' %>
                  </button>
                </div>
                <% cityFilterOptions.forEach(function(option) { %>
                  <div
                    class="area-menu__list"
                    data-area-group-panel="<%= option.value %>"
                    data-area-group-label="<%= option.label %>"
                    hidden
                  >
                    <button
                      type="button"
                      class="area-menu__action"
                      data-area-menu-action
                      data-region="<%= option.value %>"
                      data-district="all"
                    >
                      <%= resolvedAreaFilterConfig.allLabel || '전체' %>
                    </button>
                    <% if (Array.isArray(option.districts) && option.districts.length) { %>
                      <% option.districts.forEach(function(district) { %>
                        <button
                          type="button"
                          class="area-menu__action"
                          data-area-menu-action
                          data-region="<%= option.value %>"
                          data-district="<%= district %>"
                        >
                          <%= district %>
                        </button>
                      <% }) %>
                    <% } else { %>
                      <p class="area-menu__empty">등록된 구/군이 없습니다.</p>
                    <% } %>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        </div>
      <% } %>
      <% if (cityFilterOptions.length) { %>
        <script id="city-district-data" type="application/json">
          <%- JSON.stringify(cityFilterOptions.reduce(function(acc, option) {
                acc[option.value] = option.districts;
                return acc;
              }, {})) %>
        </script>
      <% } %>
    </header>
    <% if (resolvedLanguageOptions.length) { %>
      <% const languageLabel = (t && t.header && t.header.languageLabel) || 'Language'; %>
      <div class="language-select language-select--floating" data-language-select>
        <button
          type="button"
          class="language-select__toggle"
          data-language-toggle
          aria-label="<%= languageLabel %>"
          aria-expanded="false"
        >
          <% if (currentLanguageOption && currentLanguageOption.flagSrc) { %>
            <img
              class="language-select__flag"
              src="<%= currentLanguageOption.flagSrc %>"
              alt="<%= currentLanguageOption.flagAlt || '' %>"
            />
          <% } %>
          <span class="language-select__label">
            <%= (currentLanguageOption && currentLanguageOption.code ? currentLanguageOption.code.toUpperCase() : languageLabel) %>
          </span>
          <span class="language-select__icon" aria-hidden="true">▾</span>
        </button>
        <ul
          class="language-select__options"
          data-language-options
          role="listbox"
          aria-label="<%= languageLabel %>"
          hidden
        >
          <% resolvedLanguageOptions.forEach(function(option) { %>
            <li>
              <button
                type="button"
                class="language-select__option <%= option.isCurrent ? 'is-active' : '' %>"
                data-language-option
                data-language-value="<%= option.url %>"
                role="option"
                aria-selected="<%= option.isCurrent ? 'true' : 'false' %>"
              >
                <% if (option.flagSrc) { %>
                  <img
                    class="language-select__option-flag"
                    src="<%= option.flagSrc %>"
                    alt="<%= option.flagAlt || '' %>"
                  />
                <% } %>
                <span class="language-select__option-label"><%= option.code ? option.code.toUpperCase() : option.label %></span>
              </button>
            </li>
          <% }) %>
        </ul>
      </div>
    <% } %>
    <main class="site-main">
